<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net Worth Dynamics Calculator</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .entries-container {
            margin-bottom: 20px;
        }
        
        .entry {
            display: grid;
            grid-template-columns: 140px 120px 100px 120px 120px 140px;
            align-items: center;
            gap: 10px;
            padding: 15px;
            padding-right: 60px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .entry:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }
        
        .entry-type {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .entry-type select {
            flex: 1;
        }
        
        .entry-field {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }
        
        .entry input, .entry select {
            padding: 8px 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
            width: 100%;
        }
        
        .entry input:focus, .entry select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .entry input.positive {
            color: #10b981;
            font-weight: 600;
        }
        
        .entry input.negative {
            color: #ef4444;
            font-weight: 600;
        }
        
        .entry-label {
            font-size: 11px;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        button {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-remove {
            background: #ef4444;
            border: none;
            color: white;
            padding: 8px;
            font-size: 18px;
            height: 36px;
            width: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .btn-remove:hover {
            background: #dc2626;
            transform: scale(1.1);
        }
        
        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .control-group label {
            font-size: 14px;
            font-weight: 600;
            color: #666;
        }
        
        .control-group input, .control-group select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }
        
        .result-card {
            padding: 15px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 10px;
            text-align: center;
        }
        
        .result-label {
            font-size: 11px;
            color: #666;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        .result-value {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 3px;
        }
        
        .result-subtitle {
            font-size: 0.85rem;
            color: #666;
        }
        
        .positive {
            color: #10b981;
        }
        
        .negative {
            color: #ef4444;
        }
        
        .neutral {
            color: #333;
        }
        
        #graph {
            margin-top: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .hidden {
            display: none;
        }
        
        @media (max-width: 968px) {
            .entry {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .entry-field {
                width: 100%;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .control-group {
                justify-content: space-between;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                border-radius: 0;
            }
            
            body {
                padding: 0;
            }
            
            .results {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function App() {
            const [entries, setEntries] = useState([
                { id: 0, amount: '', rate: '', type: 'asset', compounding: 'annual', frequency: 'once', period: 'monthly', periodValue: 12, timing: 0 }
            ]);
            const [nextId, setNextId] = useState(1);
            const [results, setResults] = useState(null);
            const [projectionYears, setProjectionYears] = useState(10);
            const [dataPointFrequency, setDataPointFrequency] = useState('monthly');
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            const typeConfig = {
                asset: { emoji: 'ðŸ’°', label: 'Asset', sign: 1 },
                debt: { emoji: 'ðŸ’³', label: 'Debt', sign: -1 },
                income: { emoji: 'ðŸ’µ', label: 'Income', sign: 1 },
                expense: { emoji: 'ðŸ“‰', label: 'Expense', sign: -1 }
            };

            useEffect(() => {
                const saved = localStorage.getItem('networthCalculatorData');
                if (saved) {
                    try {
                        const parsed = JSON.parse(saved);
                        // Fix old entries that don't have frequency field
                        const fixedEntries = (parsed.entries || entries).map(entry => {
                            if ((entry.type === 'income' || entry.type === 'expense') && !entry.frequency) {
                                return { ...entry, frequency: 'recurring' };
                            }
                            return entry;
                        });
                        setEntries(fixedEntries);
                        setProjectionYears(parsed.projectionYears || 10);
                        setNextId(parsed.nextId || 1);
                        setDataPointFrequency(parsed.dataPointFrequency || 'monthly');
                    } catch (e) {
                        console.error('Error loading saved data:', e);
                    }
                }
            }, []);

            useEffect(() => {
                localStorage.setItem('networthCalculatorData', JSON.stringify({ 
                    entries, 
                    projectionYears, 
                    nextId,
                    dataPointFrequency 
                }));
            }, [entries, projectionYears, nextId, dataPointFrequency]);

            const addEntry = () => {
                setEntries([...entries, { 
                    id: nextId, 
                    amount: '', 
                    rate: '', 
                    type: 'asset', 
                    compounding: 'annual',
                    frequency: 'once',
                    period: 'monthly',
                    periodValue: 12,
                    timing: 0
                }]);
                setNextId(nextId + 1);
            };

            const removeEntry = (id) => {
                if (entries.length > 1) {
                    setEntries(entries.filter(entry => entry.id !== id));
                } else {
                    alert("At least one entry is required!");
                }
            };

            const updateEntry = (id, field, value) => {
                setEntries(entries.map(entry => {
                    if (entry.id === id) {
                        const updated = { ...entry, [field]: value };
                        
                        // Reset fields based on type
                        if (field === 'type') {
                            if (value === 'income' || value === 'expense') {
                                updated.rate = '0';
                                updated.compounding = 'none';
                                updated.frequency = 'recurring';  // Default to recurring for income/expense
                            } else {
                                updated.frequency = 'once';  // Assets/debts don't recur
                            }
                        }
                        
                        return updated;
                    }
                    return entry;
                }));
            };

            const calculateFV = (principal, annualRate, months, compounding) => {
                const years = months / 12;
                if (years === 0) return principal;
                
                if (compounding === 'none' || !compounding) {
                    return principal * (1 + annualRate * years);
                } else if (compounding === 'annual') {
                    return principal * Math.pow(1 + annualRate, years);
                } else if (compounding === 'monthly') {
                    const monthlyRate = annualRate / 12;
                    return principal * Math.pow(1 + monthlyRate, months);
                } else if (compounding === 'daily') {
                    const dailyRate = annualRate / 365;
                    const days = months * 30.417; // Average days per month
                    return principal * Math.pow(1 + dailyRate, days);
                }
                return principal;
            };

            const getMonthsFromTiming = (timing, periodValue) => {
                return timing * periodValue;
            };

            const calculate = () => {
                let totalAssets = 0;
                let totalDebts = 0;
                let totalAnnualInterest = 0;
                let recurringMonthlyIncome = 0;
                let recurringMonthlyExpense = 0;

                entries.forEach(entry => {
                    const amount = parseFloat(entry.amount) || 0;
                    const rate = parseFloat(entry.rate) || 0;
                    const sign = typeConfig[entry.type].sign;
                    
                    if (entry.type === 'asset') {
                        totalAssets += Math.abs(amount);
                        totalAnnualInterest += Math.abs(amount) * (Math.abs(rate) / 100);
                    } else if (entry.type === 'debt') {
                        totalDebts += Math.abs(amount);
                        totalAnnualInterest -= Math.abs(amount) * (Math.abs(rate) / 100);
                    } else if (entry.type === 'income' && (entry.frequency === 'recurring' || entry.frequency === undefined)) {
                        if (entry.period === 'monthly') {
                            recurringMonthlyIncome += Math.abs(amount);
                        } else if (entry.period === 'yearly') {
                            recurringMonthlyIncome += Math.abs(amount) / 12;
                        }
                    } else if (entry.type === 'expense' && (entry.frequency === 'recurring' || entry.frequency === undefined)) {
                        if (entry.period === 'monthly') {
                            recurringMonthlyExpense += Math.abs(amount);
                        } else if (entry.period === 'yearly') {
                            recurringMonthlyExpense += Math.abs(amount) / 12;
                        }
                    }
                });

                const netWorth = totalAssets - totalDebts;
                
                // Calculate total flows including recurring income/expenses
                const totalAnnualFlow = totalAnnualInterest + (recurringMonthlyIncome * 12) - (recurringMonthlyExpense * 12);
                const monthlyFlow = totalAnnualFlow / 12;
                const dailyFlow = totalAnnualFlow / 365;
                
                
                // Calculate percentages based on total flow (including income/expenses)
                const absNetWorth = Math.abs(netWorth);
                const annualPercentage = absNetWorth !== 0 ? (totalAnnualFlow / absNetWorth * 100) : 0;
                const monthlyPercentage = absNetWorth !== 0 ? (monthlyFlow / absNetWorth * 100) : 0;
                const dailyPercentage = absNetWorth !== 0 ? (dailyFlow / absNetWorth * 100) : 0;

                setResults({
                    netWorth,
                    totalAssets,
                    totalDebts,
                    totalAnnualInterest: totalAnnualFlow,  // Now includes all flows
                    monthlyInterest: monthlyFlow,          // Now includes all flows
                    dailyInterest: dailyFlow,              // Now includes all flows
                    annualPercentage,
                    monthlyPercentage,
                    dailyPercentage,
                    recurringMonthlyIncome: recurringMonthlyIncome * 12,
                    recurringMonthlyExpense: recurringMonthlyExpense * 12
                });

                // Project networth with monthly precision
                const totalMonths = projectionYears * 12;
                const dataPoints = [];
                const labels = [];
                
                // Determine data point interval
                let monthInterval = 1;
                if (dataPointFrequency === 'quarterly') monthInterval = 3;
                else if (dataPointFrequency === 'yearly') monthInterval = 12;
                
                for (let month = 0; month <= totalMonths; month += monthInterval) {
                    let totalValue = 0;
                    
                    entries.forEach(entry => {
                        const amount = parseFloat(entry.amount) || 0;
                        const rate = parseFloat(entry.rate) || 0;
                        const sign = typeConfig[entry.type].sign;
                        
                        if (entry.type === 'asset' || entry.type === 'debt') {
                            // Assets and debts with interest
                            const absAmount = Math.abs(amount);
                            const absRate = Math.abs(rate);
                            const fv = calculateFV(absAmount, absRate / 100, month, entry.compounding || 'none');
                            totalValue += fv * sign;
                        } else if (entry.type === 'income' || entry.type === 'expense') {
                            const absAmount = Math.abs(amount);
                            if (entry.frequency === 'once') {
                                // One-time income/expense
                                const eventMonth = getMonthsFromTiming(entry.timing || 0, entry.periodValue || 1);
                                if (month >= eventMonth) {
                                    totalValue += absAmount * sign;
                                }
                            } else if (entry.frequency === 'recurring' || entry.frequency === undefined) {
                                // Recurring income/expense
                                let monthlyAmount = absAmount;
                                if (entry.period === 'yearly') {
                                    monthlyAmount = absAmount / 12;
                                }
                                totalValue += monthlyAmount * month * sign;
                            }
                        }
                    });
                    
                    dataPoints.push(totalValue);
                    
                    // Create label
                    if (month === 0) {
                        labels.push('Now');
                    } else if (month < 12) {
                        labels.push(`${month}m`);
                    } else {
                        const years = Math.floor(month / 12);
                        const months = month % 12;
                        if (months === 0) {
                            labels.push(`${years}y`);
                        } else {
                            labels.push(`${years}y ${months}m`);
                        }
                    }
                }

                // Draw graph
                if (chartInstance.current) {
                    chartInstance.current.destroy();
                }
                const ctx = chartRef.current.getContext('2d');
                chartInstance.current = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Projected Net Worth (â‚½)',
                            data: dataPoints,
                            borderColor: 'rgba(102, 126, 234, 1)',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            fill: true,
                            tension: 0.3,
                            pointRadius: (context) => context.dataIndex === 0 ? 6 : 2,
                            pointBackgroundColor: (context) => {
                                return context.dataIndex === 0 ? '#ff6b6b' : 'rgba(102, 126, 234, 1)';
                            },
                            pointBorderColor: (context) => {
                                return context.dataIndex === 0 ? '#ff6b6b' : 'rgba(102, 126, 234, 1)';
                            }
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const value = context.parsed.y;
                                        const formatted = new Intl.NumberFormat('ru-RU').format(Math.round(value));
                                        return `Net Worth: ${value >= 0 ? '+' : ''}${formatted} â‚½`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                title: {
                                    display: true,
                                    text: 'Net Worth (â‚½)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        const formatted = new Intl.NumberFormat('ru-RU').format(value);
                                        return `${value >= 0 ? '+' : ''}${formatted}`;
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time'
                                }
                            }
                        }
                    }
                });
            };

            useEffect(() => {
                calculate();
            }, [entries, projectionYears, dataPointFrequency]);

            const formatCurrency = (value) => {
                const formatted = new Intl.NumberFormat('ru-RU').format(Math.round(Math.abs(value)));
                return `${value >= 0 ? '+' : '-'}${formatted} â‚½`;
            };

            const formatPercentage = (value) => {
                return `${value >= 0 ? '+' : ''}${value.toFixed(2)}%`;
            };

            const getInputClass = (value) => {
                const num = parseFloat(value);
                if (isNaN(num) || num === 0) return '';
                return num > 0 ? 'positive' : 'negative';
            };

            const formatInputValue = (value, field, type) => {
                if (value === '' || value === undefined) return '';
                const strValue = String(value);
                if (strValue === '-' || strValue === '+') return strValue;
                
                const num = parseFloat(strValue);
                if (isNaN(num)) return strValue;
                if (num === 0) return '0';
                
                // For amount fields
                if (field === 'amount') {
                    if (type === 'asset' || type === 'income') {
                        return num > 0 ? `+${num}` : String(num);
                    } else if (type === 'debt' || type === 'expense') {
                        return num > 0 ? `-${num}` : String(num);
                    }
                }
                
                // For rate fields
                if (field === 'rate') {
                    if (type === 'asset') {
                        return num > 0 ? `+${num}` : String(num);
                    } else if (type === 'debt') {
                        return num > 0 ? `-${num}` : String(num);
                    }
                }
                
                return String(num);
            };

            const isRecurringType = (type) => type === 'income' || type === 'expense';
            const needsRate = (type) => type === 'asset' || type === 'debt';

            return (
                <div className="container">
                    <h1>ðŸ’¼ Net Worth Dynamics Calculator</h1>
                    
                    <div className="entries-container">
                        {entries.map(entry => (
                            <div key={entry.id} className="entry">
                                <div className="entry-field">
                                    <div className="entry-label">Type</div>
                                    <div className="entry-type">
                                        <span>{typeConfig[entry.type].emoji}</span>
                                        <select
                                            value={entry.type}
                                            onChange={(e) => updateEntry(entry.id, 'type', e.target.value)}
                                        >
                                            <option value="asset">Asset</option>
                                            <option value="debt">Debt</option>
                                            <option value="income">Income</option>
                                            <option value="expense">Expense</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div className="entry-field">
                                    <div className="entry-label">Amount</div>
                                    <input
                                        type="text"
                                        value={formatInputValue(entry.amount, 'amount', entry.type)}
                                        className={getInputClass(formatInputValue(entry.amount, 'amount', entry.type))}
                                        placeholder="0"
                                        onChange={(e) => {
                                            const val = e.target.value.replace(/[^0-9.-]/g, '').replace(/^-/, '');
                                            updateEntry(entry.id, 'amount', val);
                                        }}
                                    />
                                </div>
                                
                                {needsRate(entry.type) ? (
                                    <>
                                        <div className="entry-field">
                                            <div className="entry-label">Rate %</div>
                                            <input
                                                type="text"
                                                step="0.1"
                                                value={formatInputValue(entry.rate, 'rate', entry.type)}
                                                className={getInputClass(formatInputValue(entry.rate, 'rate', entry.type))}
                                                placeholder="0"
                                                onChange={(e) => {
                                                    const val = e.target.value.replace(/[^0-9.-]/g, '').replace(/^-/, '');
                                                    updateEntry(entry.id, 'rate', val);
                                                }}
                                            />
                                        </div>
                                        
                                        <div className="entry-field">
                                            <div className="entry-label">Compound</div>
                                            <select
                                                value={entry.compounding}
                                                onChange={(e) => updateEntry(entry.id, 'compounding', e.target.value)}
                                            >
                                                <option value="none">None</option>
                                                <option value="annual">Annual</option>
                                                <option value="monthly">Monthly</option>
                                                <option value="daily">Daily</option>
                                            </select>
                                        </div>
                                    </>
                                ) : (
                                    <>
                                        <div className="entry-field">
                                            <div className="entry-label">Frequency</div>
                                            <select
                                                value={entry.frequency}
                                                onChange={(e) => updateEntry(entry.id, 'frequency', e.target.value)}
                                            >
                                                <option value="once">One-time</option>
                                                <option value="recurring">Recurring</option>
                                            </select>
                                        </div>
                                        
                                        {entry.frequency === 'once' ? (
                                            <div className="entry-field">
                                                <div className="entry-label">When</div>
                                                <div style={{display: 'flex', gap: '5px'}}>
                                                    <input
                                                        type="number"
                                                        value={entry.timing}
                                                        placeholder="0"
                                                        style={{width: '60px'}}
                                                        onChange={(e) => updateEntry(entry.id, 'timing', e.target.value)}
                                                    />
                                                    <select
                                                        value={entry.periodValue}
                                                        style={{width: '60px'}}
                                                        onChange={(e) => updateEntry(entry.id, 'periodValue', e.target.value)}
                                                    >
                                                        <option value="1">month</option>
                                                        <option value="12">year</option>
                                                    </select>
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="entry-field">
                                                <div className="entry-label">Period</div>
                                                <select
                                                    value={entry.period}
                                                    onChange={(e) => updateEntry(entry.id, 'period', e.target.value)}
                                                >
                                                    <option value="monthly">Monthly</option>
                                                    <option value="yearly">Yearly</option>
                                                </select>
                                            </div>
                                        )}
                                    </>
                                )}
                                
                                {!isRecurringType(entry.type) && entry.frequency !== 'once' && (
                                    <div className="entry-field" style={{visibility: 'hidden'}}>
                                        <div className="entry-label">&nbsp;</div>
                                        <div>&nbsp;</div>
                                    </div>
                                )}
                                
                                {!needsRate(entry.type) && entry.frequency !== 'once' && (
                                    <div className="entry-field" style={{visibility: 'hidden'}}>
                                        <div className="entry-label">&nbsp;</div>
                                        <div>&nbsp;</div>
                                    </div>
                                )}
                                
                                <button className="btn-remove" onClick={() => removeEntry(entry.id)} title="Remove entry">
                                    âœ•
                                </button>
                            </div>
                        ))}
                    </div>
                    
                    <div className="controls">
                        <button className="btn-primary" onClick={addEntry}>
                            âž• Add Entry
                        </button>
                        
                        <div className="control-group">
                            <label>Projection:</label>
                            <input
                                type="number"
                                value={projectionYears}
                                onChange={(e) => setProjectionYears(parseInt(e.target.value) || 10)}
                                min="1"
                                max="50"
                                style={{width: '60px'}}
                            />
                            <span>years</span>
                        </div>
                        
                        <div className="control-group">
                            <label>Data Points:</label>
                            <select
                                value={dataPointFrequency}
                                onChange={(e) => setDataPointFrequency(e.target.value)}
                            >
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                                <option value="yearly">Yearly</option>
                            </select>
                        </div>
                    </div>
                    
                    {results && (
                        <div className="results">
                            <div className="result-card">
                                <div className="result-label">Net Worth</div>
                                <div className={`result-value ${results.netWorth >= 0 ? 'positive' : 'negative'}`}>
                                    {formatCurrency(results.netWorth)}
                                </div>
                            </div>
                            
                            <div className="result-card">
                                <div className="result-label">Total Assets</div>
                                <div className="result-value positive">
                                    {formatCurrency(results.totalAssets)}
                                </div>
                            </div>
                            
                            <div className="result-card">
                                <div className="result-label">Total Debts</div>
                                <div className="result-value negative">
                                    {formatCurrency(-Math.abs(results.totalDebts))}
                                </div>
                            </div>
                            
                            <div className="result-card">
                                <div className="result-label">Annual Flow</div>
                                <div className={`result-value ${results.totalAnnualInterest >= 0 ? 'positive' : 'negative'}`}>
                                    {formatCurrency(results.totalAnnualInterest)}
                                </div>
                                <div className={`result-subtitle ${results.annualPercentage >= 0 ? 'positive' : 'negative'}`}>
                                    {formatPercentage(results.annualPercentage)} per year
                                </div>
                            </div>
                            
                            <div className="result-card">
                                <div className="result-label">Monthly Flow</div>
                                <div className={`result-value ${results.monthlyInterest >= 0 ? 'positive' : 'negative'}`}>
                                    {formatCurrency(results.monthlyInterest)}
                                </div>
                                <div className={`result-subtitle ${results.monthlyPercentage >= 0 ? 'positive' : 'negative'}`}>
                                    {formatPercentage(results.monthlyPercentage)} per month
                                </div>
                            </div>
                            
                            <div className="result-card">
                                <div className="result-label">Daily Flow</div>
                                <div className={`result-value ${results.dailyInterest >= 0 ? 'positive' : 'negative'}`}>
                                    {formatCurrency(results.dailyInterest)}
                                </div>
                                <div className={`result-subtitle ${results.dailyPercentage >= 0 ? 'positive' : 'negative'}`}>
                                    {formatPercentage(results.dailyPercentage)} per day
                                </div>
                            </div>
                            
                            {results.recurringMonthlyIncome > 0 && (
                                <div className="result-card">
                                    <div className="result-label">Recurring Income</div>
                                    <div className="result-value positive">
                                        {formatCurrency(results.recurringMonthlyIncome)}
                                    </div>
                                    <div className="result-subtitle">per year</div>
                                </div>
                            )}
                            
                            {results.recurringMonthlyExpense > 0 && (
                                <div className="result-card">
                                    <div className="result-label">Recurring Expense</div>
                                    <div className="result-value negative">
                                        {formatCurrency(-results.recurringMonthlyExpense)}
                                    </div>
                                    <div className="result-subtitle">per year</div>
                                </div>
                            )}
                        </div>
                    )}
                    
                    <div className="chart-container">
                        <canvas ref={chartRef}></canvas>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>